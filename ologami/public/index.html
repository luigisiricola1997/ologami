<!DOCTYPE html>
<html>
<head>
  <title>Ologami</title>
</head>
<body>

<h1>NodeJS Logger</h1>

<button id="clearLogs">Elimina Log</button>

<div id="logs"></div>

<script>
  const ws = new WebSocket('ws://localhost:3000');
  const clearLogsButton = document.getElementById('clearLogs');
  const logDiv = document.getElementById('logs');

  // Funzione per aggiungere log al div
  function addLog(log) {
    logDiv.innerHTML += `<p><strong>Message:</strong> ${log.message}, <strong>Type:</strong> ${log.type}, <strong>Timestamp:</strong> ${log.timestamp}</p>`;
  }

  ws.addEventListener('message', (event) => {
    const logs = JSON.parse(event.data);
    logs.forEach(addLog);
  });

  // Funzione per eliminare i log dalla pagina
  clearLogsButton.addEventListener('click', () => {
    logDiv.innerHTML = '';
  });

  async function loadHistoricalLogs() {
    try {
      const response = await fetch('http://localhost:3000/historical-logs');
      if (response.ok) {
        const logs = await response.json();
        logs.forEach(addLog);
      } else {
        console.error('Failed to load historical logs');
      }
    } catch (error) {
      console.error(error);
    }
  }

  // Carica i log storici quando la pagina viene caricata
  document.addEventListener('DOMContentLoaded', () => {
    loadHistoricalLogs();
  });
</script>

</body>
</html>
